from django.core.management import base, call_command
from django.db import connection


class Command(base.BaseCommand):
    def handle(self, *args, **options):
        # json_obj = {"name":"This or That","qset":{"version":2,"data":{"items":[{"materiaType":"question","id":None,"type":"MC","questions":[{"text":"Which of these paintings is from the Baroque period?"}],"answers":[{"id":None,"text":"The Fall of Phaeton by Peter Paul Rubens","value":100,"options":{"asset":{"materiaType":"asset","id":"<%MEDIA='assets/img/demo/the_fall_of_phaeton.jpg'%>"},"feedback":"The Fall of Phaeton was painted during the Baroque period by artist Peter Paul Rubens."}},{"id":None,"text":"The Mona Lisa by Leonardo DaVinci","value":0,"options":{"asset":{"materiaType":"asset","id":"<%MEDIA='assets/img/demo/mona_lisa.jpg'%>"},"feedback":"The Mona Lisa was painted during the Italian Renaissance by artist Leonardo DaVinci."}}]},{"materiaType":"question","id":None,"type":"MC","questions":[{"text":"Which of these video games is from the 1990s?"}],"answers":[{"id":None,"text":"Super Mario 64","value":100,"options":{"asset":{"materiaType":"asset","id":"<%MEDIA='assets/img/demo/mario.jpg'%>"},"feedback":"Super Mario 64 was released in 1996 for the Nintendo 64."}},{"id":None,"text":"World of Warcraft","value":0,"options":{"asset":{"materiaType":"asset","id":"<%MEDIA='assets/img/demo/wow.jpg'%>"},"feedback":"World of Warcraft was released in 2004."}}]},{"materiaType":"question","id":None,"type":"MC","questions":[{"text":"Which one of these dogs is a Labrador Retriever?"}],"answers":[{"id":None,"text":"A large yellow dog named Chance","value":100,"options":{"asset":{"materiaType":"asset","id":"<%MEDIA='assets/img/demo/chance.jpg'%>"},"feedback":"This large yellow dog named Chance is a Labrador Retriever."}},{"id":None,"text":"A small black and white dog named Bogart","value":0,"options":{"asset":{"materiaType":"asset","id":"<%MEDIA='assets/img/demo/bogart.jpg'%>"},"feedback":"This small black and white dog named Bogart is not a Labrador Retriever."}}]},{"materiaType":"question","id":None,"type":"MC","questions":[{"text":"Which sound are you more likely to hear in a forest?"}],"answers":[{"id":None,"text":"Birds chirping","value":100,"options":{"asset":{"materiaType":"asset","id":"<%MEDIA='assets/img/demo/birds.mp3'%>","type":"audio","value":"<%MEDIA='assets/img/demo/birds.mp3'%>"}}},{"id":None,"text":"A popular music video","value":0,"options":{"asset":{"materiaType":"asset","value":"https://www.youtube.com/embed/dQw4w9WgXcQ","type":"video"},"feedback":"You are less likely to get rick rolled in a forest."}}]},{"materiaType":"question","id":None,"type":"MC","questions":[{"text":"What are the four Galilean Moons of Jupiter?"}],"answers":[{"id":None,"text":"-","value":100,"options":{"asset":{"materiaType":"asset","value":"Io, Europa, Ganymede, Callisto","type":"text"},"feedback":"Io, Europa, Ganymede, Callisto are the four Galilean Moons of Jupiter."}},{"id":None,"text":"-","value":0,"options":{"asset":{"materiaType":"asset","value":"Titan, Iapetus, Mimas, Enceladus","type":"text"},"feedback":"Titan, Iapetus, Mimas, Enceladus are moons of Saturn."}}]}]}}}
        import json
        import re
        json_obj = [{"prop":"<%MEDIA='path/to/media/asset1.jpg'%>"},{"prop":"<%MEDIA='path/to/media/asset2.jpg'%>"}]
        json_text = json.dumps(json_obj)

        pattern = r"<%\s*MEDIA\s*=\s*('|\")([^'\"]*?)\1\s*%>"
        matches = re.findall(pattern, json_text)

        print(matches) # []
